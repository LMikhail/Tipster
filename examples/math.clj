(ns math
  (:require [tipster.core :as tipster]))

(defn description
  "–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞"
  []
  {:title "üî¢ –ü—Ä–∏–º–µ—Ä 5: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è"
   :subtitle "–ò–∑—É—á–∞–µ–º —á–∏—Å–ª–æ–≤—É—é –ª–æ–≥–∏–∫—É"
   :what-you-learn ["–†–∞–±–æ—Ç–∞ —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"
                    "–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è"
                    "–ü—Ä–∞–≤–∏–ª–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–∏—Å–µ–ª"
                    "–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è"]
   :next "./scripts/run-example.sh interactive"})

(defn run-example
  "–ó–∞–ø—É—Å–∫ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞"
  []
  (println "\nüîπ –ü—Ä–∏–º–µ—Ä 5: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è")
  (println (apply str (repeat 50 "=")))
  
  (tipster/reset-tipster!)
  
  ;; –ß–∏—Å–ª–æ–≤—ã–µ —Ñ–∞–∫—Ç—ã
  (tipster/deffact (—á–∏—Å–ª–æ 1))
  (tipster/deffact (—á–∏—Å–ª–æ 2))
  (tipster/deffact (—á–∏—Å–ª–æ 3))
  (tipster/deffact (—á–∏—Å–ª–æ 4))
  (tipster/deffact (—á–∏—Å–ª–æ 5))
  
  ;; –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è
  (tipster/deffact (–±–æ–ª—å—à–µ 2 1))
  (tipster/deffact (–±–æ–ª—å—à–µ 3 2))
  (tipster/deffact (–±–æ–ª—å—à–µ 4 3))
  (tipster/deffact (–±–æ–ª—å—à–µ 5 4))
  (tipster/deffact (–±–æ–ª—å—à–µ 3 1))
  (tipster/deffact (–±–æ–ª—å—à–µ 4 2))
  (tipster/deffact (–±–æ–ª—å—à–µ 5 3))
  
  ;; –ü—Ä–∞–≤–∏–ª–∞
  (tipster/defrule (—á–µ—Ç–Ω–æ–µ 2) [])
  (tipster/defrule (—á–µ—Ç–Ω–æ–µ 4) [])
  (tipster/defrule (–Ω–µ—á–µ—Ç–Ω–æ–µ 1) [])
  (tipster/defrule (–Ω–µ—á–µ—Ç–Ω–æ–µ 3) [])
  (tipster/defrule (–Ω–µ—á–µ—Ç–Ω–æ–µ 5) [])
  
  (tipster/defrule (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ ?X) 
                   [(—á–∏—Å–ª–æ ?X) (–±–æ–ª—å—à–µ ?X 0)])
  
  (println "\nüìù –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∞!")
  
  (println "\n‚ùì –ó–∞–ø—Ä–æ—Å: –ö–∞–∫–∏–µ —á–∏—Å–ª–∞ —á–µ—Ç–Ω—ã–µ?")
  (println "   query: (—á–µ—Ç–Ω–æ–µ ?X)")
  (doseq [result (tipster/query (—á–µ—Ç–Ω–æ–µ ?X))]
    (println "   ‚úì " result))
  
  (println "\n‚ùì –ó–∞–ø—Ä–æ—Å: –ß—Ç–æ –±–æ–ª—å—à–µ —á–µ–≥–æ?")
  (println "   query: (–±–æ–ª—å—à–µ ?X ?Y)")
  (doseq [result (take 5 (tipster/query (–±–æ–ª—å—à–µ ?X ?Y)))]
    (println "   ‚úì " result))
  
  (println "   ... (–ø–æ–∫–∞–∑–∞–Ω—ã –ø–µ—Ä–≤—ã–µ 5)")) 
